<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>豆瓣TOP250电影下载并存储</title>
    <url>/2020/04/19/TOP250%E7%94%B5%E5%BD%B1%E4%B8%8B%E8%BD%BD/</url>
    <content><![CDATA[<h3 id="明确目标"><a href="#明确目标" class="headerlink" title="明确目标"></a>明确目标</h3><p>–爬取top250电影的（序号、电影名称、评分、推荐语、链接），并按分类存储</p>
<h3 id="需求说明"><a href="#需求说明" class="headerlink" title="需求说明"></a>需求说明</h3><p>–方便本地随时查看，并结合TOP前250电影数据分析策略的影响面，持续优化可调整权重；<br>–提升用户增长指数</p>
<h3 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h3><p>–1.0版本获取数据，并打印；<br>–2.0版本在1.0版上新增excel存储</p>
<a id="more"></a>
<h3 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h3><p><img src="/images/liuchengtu.jpg" alt="(可以写关于图片的描述)"></p>
<h3 id="1-0–打印文本"><a href="#1-0–打印文本" class="headerlink" title="1.0–打印文本"></a>1.0–打印文本</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ import requests</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(10):</span><br><span class="line">    headers = &#123;<span class="string">'User-Agent'</span>:<span class="string">'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36'</span>&#125;  </span><br><span class="line">    url_1=<span class="string">'https://movie.douban.com/top250?start='</span>+str(x*25)+<span class="string">'&amp;filter='</span></span><br><span class="line">    res=requests.get(url_1,headers=headers)</span><br><span class="line">    soup = BeautifulSoup(res.text,<span class="string">'html.parser'</span>)</span><br><span class="line">    items = soup.find(<span class="string">'ol'</span>,class_=<span class="string">"grid_view"</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> items.find_all(<span class="string">'li'</span>):</span><br><span class="line">        xuhao = i.find(<span class="string">'em'</span>,class_=<span class="string">""</span>).text</span><br><span class="line">        dym = i.find(<span class="string">'span'</span>,class_=<span class="string">"title"</span>).text</span><br><span class="line">        pf = i.find(<span class="string">'span'</span>,property=<span class="string">"v:average"</span>).text       </span><br><span class="line">        url = i.find(<span class="string">'a'</span>)[<span class="string">'href'</span>]</span><br><span class="line">        <span class="keyword">if</span> i.find(<span class="string">'span'</span>,class_=<span class="string">"inq"</span>) !=None:</span><br><span class="line">            tjy = i.find(<span class="string">'span'</span>,class_=<span class="string">"inq"</span>).text</span><br><span class="line">            <span class="built_in">print</span>(xuhao+<span class="string">'.'</span>+dym+<span class="string">'--'</span>+pf+<span class="string">'\n'</span>+<span class="string">'推荐语:'</span>+tjy+<span class="string">'\n'</span>+url)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">'----------------------'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(xuhao+<span class="string">'.'</span>+dym+<span class="string">'--'</span>+pf+<span class="string">'\n'</span>+url)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">'----------------------'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="1-0-文本输出"><a href="#1-0-文本输出" class="headerlink" title="1.0-文本输出"></a>1.0-文本输出</h3><p><img src="/images/image.png" alt="(可以写关于图片的描述)"></p>
<h3 id="2-0-Excel存储"><a href="#2-0-Excel存储" class="headerlink" title="2.0-Excel存储"></a>2.0-Excel存储</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ import requests,openpyxl</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line"></span><br><span class="line">wb=openpyxl.Workbook()</span><br><span class="line"><span class="comment">#创建工作簿</span></span><br><span class="line">sheet=wb.active</span><br><span class="line"><span class="comment">#获取工作簿的活动表</span></span><br><span class="line">sheet.title=<span class="string">'豆瓣TOP250'</span></span><br><span class="line"><span class="comment">#工作表重命名</span></span><br><span class="line"></span><br><span class="line">sheet[<span class="string">'A1'</span>] =<span class="string">'序号'</span>     <span class="comment">#加表头，给A1单元格赋值</span></span><br><span class="line">sheet[<span class="string">'B1'</span>] =<span class="string">'电影名称'</span>   <span class="comment">#加表头，给B1单元格赋值</span></span><br><span class="line">sheet[<span class="string">'C1'</span>] =<span class="string">'评分'</span>   <span class="comment">#加表头，给C1单元格赋值</span></span><br><span class="line">sheet[<span class="string">'D1'</span>] =<span class="string">'推荐语'</span>   <span class="comment">#加表头，给D1单元格赋值</span></span><br><span class="line">sheet[<span class="string">'E1'</span>] =<span class="string">'电影链接'</span>   <span class="comment">#加表头，给E1单元格赋值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(10):</span><br><span class="line">    headers = &#123;<span class="string">'User-Agent'</span>:<span class="string">'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36'</span>&#125;  </span><br><span class="line">    url_1=<span class="string">'https://movie.douban.com/top250?start='</span>+str(x*25)+<span class="string">'&amp;filter='</span></span><br><span class="line">    res=requests.get(url_1,headers=headers)</span><br><span class="line">    soup = BeautifulSoup(res.text,<span class="string">'html.parser'</span>)</span><br><span class="line">    items = soup.find(<span class="string">'ol'</span>,class_=<span class="string">"grid_view"</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> items.find_all(<span class="string">'li'</span>):</span><br><span class="line">        xuhao = i.find(<span class="string">'em'</span>,class_=<span class="string">""</span>).text</span><br><span class="line">        dym = i.find(<span class="string">'span'</span>,class_=<span class="string">"title"</span>).text</span><br><span class="line">        pf = i.find(<span class="string">'span'</span>,property=<span class="string">"v:average"</span>).text       </span><br><span class="line">        url = i.find(<span class="string">'a'</span>)[<span class="string">'href'</span>]</span><br><span class="line">        <span class="keyword">if</span> i.find(<span class="string">'span'</span>,class_=<span class="string">"inq"</span>) !=None:</span><br><span class="line">            tjy = i.find(<span class="string">'span'</span>,class_=<span class="string">"inq"</span>).text</span><br><span class="line">            sheet.append([xuhao,dym,pf,tjy,url])</span><br><span class="line">            <span class="built_in">print</span>(xuhao+<span class="string">'.'</span>+dym+<span class="string">'--'</span>+pf+<span class="string">'\n'</span>+<span class="string">'推荐语:'</span>+tjy+<span class="string">'\n'</span>+url)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">'----------------------'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            sheet.append([xuhao,dym,pf,<span class="string">''</span>,url])</span><br><span class="line">            <span class="built_in">print</span>(xuhao+<span class="string">'.'</span>+dym+<span class="string">'--'</span>+pf+<span class="string">'\n'</span>+url)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">'----------------------'</span>)</span><br><span class="line">wb.save(<span class="string">'豆瓣TOP250.xlsx'</span>) </span><br><span class="line"><span class="comment">#保存并命名Excel文件</span></span><br></pre></td></tr></table></figure>
<h3 id="2-0-输出Excel存储"><a href="#2-0-输出Excel存储" class="headerlink" title="2.0-输出Excel存储"></a>2.0-输出Excel存储</h3><p><img src="/images/cunchu.gif" alt="(可以写关于图片的描述)"></p>
]]></content>
      <categories>
        <category>产品案例</category>
      </categories>
      <tags>
        <tag>产品需求</tag>
        <tag>Python</tag>
      </tags>
  </entry>
</search>
